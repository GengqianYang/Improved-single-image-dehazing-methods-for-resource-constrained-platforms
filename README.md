# Improved single image dehazing methods for resource-constrained platform
Gengqian Yangï¼Œ Adrian N. Evans

## Introduction
Image dehazing is an increasingly widespread approach to address the degradation of images of the natural environment by low-visibility weather, dust and other phenomena. Advances in autonomous systems and platforms have increased the need for low-complexity, high-performing dehazing techniques. However, while recent learning-based image dehazing approaches have significantly increased the dehazing performance, this has often been at the expense of complexity and hence the use of prior-based approaches persists, despite their lower performance. This paper addresses both these aspects and focuses on single image dehazing, the most practical class of techniques. A new Dark Channel Prior-based single image dehazing algorithm is presented that has an improved atmospheric light estimation method and a low-complexity morphological reconstruction. In addition, a novel, lightweight end-to-end network is proposed, that avoids information loss and significant computational effort by eliminating the pooling and fully connected layers. Qualitative and quantitative evaluations show that our proposed algorithms are competitive with, or outperform, state-of-the-art techniques with significantly lower complexity, demonstrating their suitability for use in resource-constrained platforms.

## Prerequisites:
Python 2 or 3\
OpenCV-Python\
PyTorch

## Algorithms
In our paper, we proposed two different single-image dehazing algorithms from different aspects.

### The RALE-RD algorithm
This is a new Dark Channel Prior-based single image dehazing algorithm that has an improved atmospheric light estimation method and a low-complexity morphological reconstruction.

The system flow diagram is given as follows:
![image](https://user-images.githubusercontent.com/62884839/126893960-9ff01eff-665d-4ce0-aa56-a91d7a4a0cdf.png)

Please check the comments to see how to run the code and generate your own results.
### The LSID-FCNN algorithm
This is a novel, light-weight end-to-end single-image dehazing network. In order to avoid information loss caused by pooling layers, a fully convolutional architecture was adopted.LSID-FCNN consists of two components: the image generator and the K-estimation module. In this way, the haze-free image is recovered from the K-map generated by the estimation network through a variant of the atmospheric scattering model.

The general architecture is shown below:
![image](https://user-images.githubusercontent.com/62884839/126894371-0886c5d1-41b7-4eee-a813-3b866b86b0a5.png)

Instructions on how to get started are given in the comments. The user can either choose their own dataset or the RESIDE DataSet to train the network. In case the user can't train the network due to the hardware restriction, a naive pre-trained model is provided.

## Training and Testing DataSet
All the training and testing samples are collected from the RESIDE DataSet. \
Here is the link of the DataSet:\
https://sites.google.com/view/reside-dehaze-datasets/reside-standard

paper:\
Benchmarking Single Image Dehazing and Beyond [https://ieeexplore.ieee.org/abstract/document/8451944]

## Citation
Please cite this paper in your publication if these codes are used in your research:

@article{Yang2021,\
        doi = {10.1007/s11554-021-01143-6},\
        url = {https://link.springer.com/article/10.1007%2Fs11554-021-01143-6}, \
        year = {2021}, \
        month = June, \
        author = {Gengqian Yang and Adrian N. Evans}, \
        title = {Improved single image dehazing methods for resource-constrained platforms}, \
        journal = {Journal of real-time image processing}\
        }
        
